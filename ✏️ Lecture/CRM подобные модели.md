# CRM подобные модели

  

**Модели емкостного сопротивления (CRM от англ. Capacitance-resistance-model)** – это быстрый инструмент для моделирования разработки месторождения с заводнением. В данной модели входными параметрами являются дебиты добывающих скважин и приемистости нагнетательных, а сама модель основана на временном параметре, который по своей сути определяет фильтрационно-емкостные свойства пласта, и связях между скважины, которые являются подобием коэффициента охвата.
<br>
Модель CRM основана на базовом принципе материального баланса.

  

$$\textrm{[Масса в объеме V во время t + }\Delta \textrm{t]} - \textrm{[Масса в объеме V во время t]} =$$<br>
 $$\textrm{[Масса, добавленная в объем V во время}\Delta\textrm{t]} - \textrm{[Масса, извлеченная из объема V во время}\Delta\textrm{t]}\tag{1.4.1}$$<br><br>
Запишем уравнение материального баланса для месторождения с заводнением:<br>
$$c_tV_p\frac{dp}{dt}=I_t-q_t \tag{1.4.2}$$<br>
Где:<br>
$c_t - \textrm{общая сжимаемость}$<br>
$V_p - \textrm{Поровый объем}$<br>
$p - \textrm{Среднее пластовое давление}$<br>
$I_t - \textrm{Закачка жидкости в пласт}$<br>
$q_t - \textrm{Добыча жидкости из пласта}$<br><br>
Рассмотрим *основные допущения* моделей типа CRM:<br>
- Модель изотермическая
- Капиллярные силы не учитываются
- Постоянный объем пласта
- Мгновенная реакция пласта на закачку/добычу
- Неизменный коэффициент продуктивности скважин
- Расходы добычи и закачки принимаются в пластовых условиях.
<br>

> В рамках курса будут рассмотрены модели, которые основаны на трех различных способах использования объемов дренирования в соответствии с суперпозицей во времени и пространстве. [Диссертация Sayarpour](../files/Sayarpour%20-%20Диссертация%20CRM.pdf)

<br><br>
1. CRMT – модель, объемом дренирования которой является весь пласт (рисунок 3.1). В этом случае используется суммарная закачка и суммарная добыча всех скважин на месторождении. То есть все скважины заменяются одной добывающей и одной нагнетательной. Следовательно, невозможно учесть забойное давление отдельных скважин. Также в этой модели учитывается, что на процесс вытеснения нефти водой идет только часть закачиваемой жидкости. Уравнение неразрывности в этой модели записывается аналогично уравнению (3.2). Таким образом, уравнение добычи записывается в следующем виде:<br>
$$q_F(t_k)=q_F(t_{k-1})e^{\frac{\Delta t_k}{\tau_{F}}}+f_F I_F^{(k)} \Bigg (1 - e^{-\frac{\Delta t_k}{\tau_F}}\Bigg ) \tag{1.4.3}$$<br>
Где:<br>
$\tau_{F}=\frac{c_t V_p}{J} - \textrm{временная константа, обратная величина которой является эквивалентом темпа падения добычи на естественном режиме работы пласта}$<br>
$V_p - \textrm{Поровый объем}$<br>
$c_t - \textrm{Общая сжимаемость}$<br>
$J - \textrm{Продуктивность}$
<br><br><br>
![**Схематическое представление CRMT**](../files/Pasted%20image%2020240131100957.png)<br>
**Схематическое представление CRMT**

  

2. CRMP – модель, объемом дренирования которой является объем вокруг добывающей скважины (рисунок 3.2), то есть у каждой добывающей скважины имеется свой поровый объем и уравнение записывается в следующем виде:

<br>


$$\frac{d q_j(t)}{dt}+\frac{1}{\tau_j} q_j(t) = \frac{1}{\tau_j} \sum_{i=1}^{N_{inj}} f_{ij} i_i(t) - J_j \frac{dp_{wf j}}{dt} \tag{1.4.4}$$<br>
Где:<br>
$i=1,2...N{inj} - \textrm{количество нагнетательных скважин}$<br>
$j=1,2...N{prod} - \textrm{количество добывающих скважин}$<br>

$\tau_j - \textrm{временная константа для } j \textrm{-ой добывающей скважины}$<br>
$f_{ij} - \textrm{Параметр взаимосвязи между скважинами, то есть доля от приемистости,}$<br> $\textrm{приходящей в зону } j \textrm{-ой добывающей скважины} i\textrm{-ой нагнетательной скважины}$<br>
$$f_{ij} = \frac{q_{ij}(t)}{i_i(t)} \tag{1.4.5}$$<br>
$$\tau_j = \Bigg( \frac{c_t V_p}{J} \Bigg)_j \tag{1.4.6}$$<br>
$V_p - \textrm{Поровый объем скважины}$<br>
$c_t - \textrm{сжимаемость}$<br>
$J - \textrm{Продуктивность скважины}$<br>

<br><br>
![****Схематическое представление CRMP****](../files/Pasted%20image%2020240131103847.png)<br>
**Схематическое представление CRMP**
  

3. CRMIP – модель, объемом дренирования которой является зона между парой нагнетательная-добывающая скважины (рисунок 3.3). Уравнение записывается в следующем виде:<br>
$$\frac{d q_{ij}(t)}{dt}+\frac{1}{\tau_{ij}} q_{ij}(t) = \frac{1}{\tau_{ij}} \sum_{i=1}^{N_{inj}} f_{ij} i_i(t) - J_j \frac{dp_{wf j}}{dt} \tag{1.4.7}$$<br>

$i=1,2...N{inj} - \textrm{количество нагнетательных скважин}$<br>
$j=1,2...N{prod} - \textrm{количество добывающих скважин}$<br>
$J_{ij} - \textrm{коэффициент продуктивности для объема между парой скважин } ij$<br>
$\tau_{ij} - \textrm{временная константа для объема между парой скважин } ij$<br><br>
![**Схематическое представление CRMIP**](../files/Pasted%20image%2020240131104530.png)<br>
**Схематическое представление CRMIP**
  

### Рассмотрим подробно на примере CRMP
<br>
На параметр взаимосвязи $f_{ij}$  **накладываются ограничения**:<br>

$$f_{ij} \geq 0 \tag{1.4.8}$$<br>
$$\sum_{i=1}^{N_{inj}} f_{ij} \leq 1 \tag{1.4.9}$$<br>
Решение уравнения **CRMP** относительно дебита в общем виде выглядит следующим образом:<br>
$$q_j(t)=q_j(t_0)e^{- \Big( \frac{t_n - t_0}{\tau_j} \Big)}+e^{-\frac{1}{\tau_j}} \int_{\xi=t_0}^{\xi=t} \frac{1}{\tau_j} \sum_{i=1}^{N_{inj}} f_{ij}i_i(\xi) d\xi - e^{-\frac{1}{\tau_j}} \int_{\xi=t_0}^{\xi=t} e^{\frac{\xi}{\tau_j}}J_j \frac{dp_{wf,j}}{d\xi}d\xi \tag{1.4.10}$$<br>
Это уравнение имеет 2 аналитических решения, онснованные на разных режимах изменения приемистости и забойного давления добывающих скважин.<br>
1. Изменение забойного давления происходит линейно, а приемистость изменяется ступенчато, так называемый SVIR (от англ. stepwise variation of injection rate - ступенчатое изменение расхода закачки). <br>

![**Кусочно-линейный график изменения забойного давления добывающей скважины от момента времени** $t_0$ до $t_n$](../files/Pasted%20image%2020240131135501.png)<br>

**Кусочно-линейный график изменения забойного давления добывающей скважины от момента времени** $t_0$ до $t_n$<br>

![**Ступенчатый график изменения приемистости нагнетательной скважины от момента времени **$t_0$ до $t_n$](../files/Pasted%20image%2020240131140047.png)<br>

**Ступенчатый график изменения приемистости нагнетательной скважины от момента времени** $t_0$ до $t_n$ <br>

2. Изменение забойного давления происходит линейно, а приемистость изменяется линейно, так называемый LVIR (от англ. linear variation of injection rate - линейное изменение расхода закачки.). Данный способ используется, так как промысловые данные записываются с определенным интервалом, но при этом, очевидно, что фактически происходит постоянное изменении замеряемых параметров.<br>

<br>
![**Кусочно-линейный график изменения приемистости нагнетательной скважины от момента времени** $t_0$ до $t_n$](../files/Pasted%20image%2020240131143810.png)<br>

**Кусочно-линейный график изменения приемистости нагнетательной скважины от момента времени** $t_0$ до $t_n$<br>



### **Решение уравнения CRM**

<br>
Как было описано выше, в уравнении CRM изменяемы следующие параметры:
<br>

$\tau_{j} - \textrm{временной параметр для } N_{prod}$<br>
$J_{j} - \textrm{Коэффициент продуктивности } N_{prod}$<br>
$q_{j}(t_0) - \textrm{начальный дебит для } N_{prod}$<br>
$f_{ij} - \textrm{коэффициент взаимосвязи между парой нагнетательная-добывающая скважины для }N_{prod}N_{inj}$<br>
Таким образом, получается, что для решения уравнения CRM требуется найти $N_{prod}(N_{inj}+3)$ параметров.<br>
Чтобы найти эти параметры нужно оптимизировать функцию CRM на промысловые данные. Запишем целевую функцию, которую будем в дальнейшем оптимизировать:<br>
$$F(\tau_{j}, J_{j}, q_{j}(t_0), f_{ij})=\sum_{t=0}^N \sum_{j=1}^{N_{prod}} \Bigg (   q_j^t - \bar {q_j}^t (\tau_{j}, J_{j}, q_{j}(t_0), f_{ij})  \Bigg ) ^2 \tag{1.4.XX}$$<br>
Где:<br>
$q_j^t - \textrm{Промысловые замеры дебита жидкости в момент времени } t$<br>
$\bar {q_j}^t - \textrm{Рассчитанный дебит жидкости в момент времени } t$<br>
$N - \textrm{Количество временных шагов}$<br>

> Для оптимизации данной функции во многих источниках рекомнедуют использовать метод **SLSQP** (от англ. Sequential Least Squares Quadratic Programming) – Последовательное квадратичное программирование методом наименьших квадратов). Метод представляет собой инструмент численной оптимизации, используемый для решения сложных задач оптимизации в областях, где как функция цели, так и ограничения являются гладкими и дифференцируемыми.

<br>
Этот метод сочетает в себе особенности метода последовательного квадратичного программирования (SQP) и метода наименьших квадратов (LS).<br>
На каждом шаге SLSQP строит аппроксимацию целевой функции в виде квадратичной модели и линейных моделей для ограничений. Затем происходит решение задачи квадратичного программирования для определения следующего приближения оптимального решения. Особенностью метода является последовательное уточнение ограничений, что делает его эффективным при учете различных типов ограничений.
