

# LSTM

**Архитектура модели LSTM показана на рисунке ниже**.  $X_i$ и $h_i$ – входные и выходные данные в текущем состоянии ячейки на шаг i соответственно. Этот цикл позволяет передавать информацию от одного шага к другому. Также есть 3 фильтра, которые позволяют контролировать и регулировать состояния ячейки. 

![](https://lh7-us.googleusercontent.com/uwtXaEXLlZEqTaGNnIt_46YX7K7Hb8bQC82TMtZZNnnQwr5y6ejhkroMPPh7ssGLWaBl-lRuGWBV0WWtp9sRXVdV16ojZkar7DeRGnzFkWJ6p7EInC9Vf61FDrK-FTx2xPcoFJ97pnDWEG2TsR7wVJ-KeC2Um-Pq)

**Архитектура модели LSTM**
<br>
**Рассмотрим пошагово, как работает ячейка LSTM:**<br>
1. Первый этап в использовании LSTM заключается в определении того, какую информацию следует исключить из состояния ячейки. Этим решением занимается сигмоидальный слой (*слой фильтра забывания*). Этот слой анализирует $x_i$ и $h_i$ и возвращает число от 0 до 1. 0 означает полностью забыть, а 1 полностью сохранить.
2. Следующим шагом является определение того, какая новая информация будет добавлена в состояние ячейки. Этот этап состоит из двух частей. Сначала сигмоидальный "слой входного фильтра" определяет, какие значения нужно обновить. Затем $tanh$ -слой создает вектор новых кандидатов $C_i$ , которые могут быть добавлены в состояние ячейки.
3. Далее заменяется старое состояние ячейки $C_{i-1}$ на новое состояние $C_i$
4. В завершении, нужно определить, какую информацию мы хотим получить на выходе. Выходные данные формируются на основе состояния ячейки и проходят через несколько фильтров. Сначала применяется сигмоидальный слой, который решает, какую информацию из состояния ячейки следует выводить. Затем значения состояния ячейки проходят через $tanh$ -слой, чтобы получить на выходе значения из диапазона от -1 до 1. Полученные значения перемножаются с выходными значениями сигмоидального слоя, что обеспечивает вывод только необходимой информации.

 
  

## Решение задачи прогнозирования с помощью LSTM

Модель LSTM можно построить с помощью языка программирования Python с использованием библиотек для конструирования нейронных сетей: [keras](https://keras.io/api/layers/), [skikit-learn](https://scikit-learn.org/stable/).

**Модель, к примеру, можно использовать для прогнозирования добычи нефти.**

Входными и выходными параметрами этой модели является суточная суммарная добыча по нефти и жидкости всего месторождения. Входные параметры будут скользить вдоль оси времени, то есть, например, если размер скользящего окна равен $t$ , данные с 1-го по $t$ -й день будут введены в обучение для прогнозирования результата $t+1$ -го дня на первом этапе. На втором этапе модель будет прогнозировать результат $t+2$ -го дня на основе данных со 2-го по $t+1$ -й день и так далее. 

  
![](https://lh7-us.googleusercontent.com/UmFh2iU7acVz2FdnUSf5ZfcCij4iScYQ5mFf_gfricnreegMkky6W2lcD9QjWJi0fTZKfcg_V-Ry_pk94nlOieh8ltSSqFMaU-nZIbbtDYQXk_vxddvKzWz8lhFSCu5FHtsVeOap7g6XWjsQrn8g-MvvxO35NkXL)

**Иллюстрация процесса скользящего окна LSTM**

Данная модель позволит прогнозировать добычу только на основе добычи за прошлые временные отрезки при условии, что в системе разработки не будет происходить крупных изменений: ввод новых скважин, ГТМ на большом количестве скважин, старт применения МУН.

![Пример прогноза LSTM](../files/Pasted%20image%2020240201135304.png)


