

# LSTM

**Архитектура модели LSTM показана на рисунке ниже**.  $X_i$ и $h_i$ – входные и выходные данные в текущем состоянии ячейки на шаг i соответственно. Этот цикл позволяет передавать информацию от одного шага к другому. Также есть 3 фильтра, которые позволяют контролировать и регулировать состояния ячейки. 

![](https://lh7-us.googleusercontent.com/uwtXaEXLlZEqTaGNnIt_46YX7K7Hb8bQC82TMtZZNnnQwr5y6ejhkroMPPh7ssGLWaBl-lRuGWBV0WWtp9sRXVdV16ojZkar7DeRGnzFkWJ6p7EInC9Vf61FDrK-FTx2xPcoFJ97pnDWEG2TsR7wVJ-KeC2Um-Pq)

**Архитектура модели LSTM**
<br>
**Рассмотрим пошагово, как работает ячейка LSTM:**<br>
1. Первый этап в использовании LSTM заключается в определении того, какую информацию следует исключить из состояния ячейки.
2. Следующим шагом является определение того, какая новая информация будет добавлена в состояние ячейки. Этот этап состоит из двух частей. Сначала сигмоидальный "слой входного фильтра" определяет, какие значения нужно обновить. Затем tanh-слой создает вектор новых кандидатов Ci, которые могут быть добавлены в состояние ячейки.  
ii=σWihi-1,xi+bi#4.2

Ci=tanhWChi-1,xi+bC#4.3

Пришло время заменить старое состояние ячейки Ci-1

 на новое состояние Ci

. Мы уже приняли решения на предыдущих этапах, поэтому теперь остается только выполнить их. Мы перемножаем старое состояние на fi

, чтобы забыть то, что решено исключить, и добавляем iiCi

. Это новые значения-кандидаты, умноженные на i

 – насколько мы хотим обновить каждое из значений состояния.

Ci=fiCi-1+iiCi#4.4

2. В завершении, нужно определить, какую информацию мы хотим получить на выходе. Выходные данные формируются на основе состояния ячейки и проходят через несколько фильтров. Сначала применяется сигмоидальный слой, который решает, какую информацию из состояния ячейки следует выводить. Затем значения состояния ячейки проходят через tanh-слой, чтобы получить на выходе значения из диапазона от -1 до 1. Полученные значения перемножаются с выходными значениями сигмоидального слоя, что обеспечивает вывод только необходимой информации.
    
 
  

4.3 Решение задачи прогнозирования с помощью LSTM

В предыдущих главах были разобраны архитектура LSTM, а также примеры применения нейронных сетей данного типа в качестве инструмента разработчика. 

Модель LSTM будут строится с помощью языка программирования Python с использованием библиотек для конструирования нейронных сетей: keras, skikit-learn.

В данной работе модель LSTM будет использоваться в двух конфигурациях:

Прогнозирование суммарной добычи по месторождению. 

Входными и выходными параметрами этой модели является суточная суммарная добыча по нефти и жидкости всего месторождения. Входные параметры будут скользить вдоль оси времени (рисунок 4.2), то есть, например, если размер скользящего окна равен t, данные с 1-го по t-й день будут введены в обучение для прогнозирования результата t+1-го дня на первом этапе. На втором этапе модель будет прогнозировать результат t+2-го дня на основе данных со 2-го по t+1-й день и так далее. 

  
![](https://lh7-us.googleusercontent.com/UmFh2iU7acVz2FdnUSf5ZfcCij4iScYQ5mFf_gfricnreegMkky6W2lcD9QjWJi0fTZKfcg_V-Ry_pk94nlOieh8ltSSqFMaU-nZIbbtDYQXk_vxddvKzWz8lhFSCu5FHtsVeOap7g6XWjsQrn8g-MvvxO35NkXL)

Рисунок 4.2 - Иллюстрация процесса скользящего окна LSTM.

Данная модель позволит прогнозировать добычу только на основе добычи за прошлые временные отрезки при условии, что в системе разработки не будет происходить крупных изменений: ввод новых скважин, ГТМ на большом количестве скважин, старт применения МУН.


